<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Browse Jobs - AtMyWorks</title>
    <link rel="stylesheet" href="css/styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <nav class="navbar">
                <a href="/index.html" class="logo">AtMyWorks</a>
                <ul class="nav-links">
                    <li><a href="/browse.html">Find Work</a></li>
                    <li><a href="/browse-jobs.html">Browse Jobs</a></li> <!-- Add link to this page -->
                    <li><a href="/blog.html">Blog</a></li>
                    <li><a href="#">How It Works</a></li>
                </ul>
                <div class="auth-buttons">
                    <button class="btn btn-outline" id="loginBtn">Log In</button>
                    <button class="btn btn-primary" id="signupBtn">Sign Up</button>
                </div>
            </nav>
        </div>
    </header>

    <!-- Search and Filters -->
    <section class="section section-gray">
        <div class="container">
            <form id="jobSearchForm" style="max-width: 800px; margin: 0 auto;">
                <div style="display: flex; gap: 1rem; margin-bottom: 2rem;">
                    <input type="text" id="jobSearchQuery" class="form-control" placeholder="Search jobs, titles, skills..." style="flex: 1;">
                    <button type="submit" class="btn btn-primary"><i class="fas fa-search"></i></button>
                </div>
                
                <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem;">
                    <select id="jobCategoryFilter" class="form-control">
                        <option value="">All Categories</option>
                        <option value="graphics-design">Graphics & Design</option>
                        <option value="digital-marketing">Digital Marketing</option>
                        <option value="programming-tech">Programming & Tech</option>
                        <option value="video-animation">Video & Animation</option>
                    </select>
                    
                    <select id="jobTypeFilter" class="form-control">
                        <option value="">All Types</option>
                        <option value="freelance">Freelance</option>
                        <option value="part-time">Part-Time</option>
                        <option value="full-time">Full-Time</option>
                        <option value="contract">Contract</option>
                    </select>
                    
                    <select id="jobExperienceFilter" class="form-control">
                        <option value="">Any Experience</option>
                        <option value="entry">Entry Level</option>
                        <option value="intermediate">Intermediate</option>
                        <option value="expert">Expert</option>
                    </select>
                    
                    <button type="button" id="resetFiltersBtn" class="btn btn-outline">Reset Filters</button>
                </div>
            </form>
        </div>
    </section>

    <!-- Job Listings -->
    <section class="section section-light">
        <div class="container">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: var(--spacing-6);">
                <h2>Available Jobs</h2>
                <div>
                    <span id="jobCount">Showing 0 jobs</span>
                </div>
            </div>
            
            <div id="jobsContainer">
                <!-- Job cards will be populated here by JavaScript -->
                <div style="text-align: center; padding: var(--spacing-10);">
                    <div class="spinner" style="width: 3rem; height: 3rem; border: 4px solid rgba(0, 0, 0, 0.1); border-left-color: var(--primary); border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 1rem;"></div>
                    <p>Loading jobs...</p>
                </div>
            </div>
            
            <!-- Pagination (Placeholder) -->
            <div style="display: flex; justify-content: center; margin-top: var(--spacing-8);">
                <nav aria-label="Page navigation">
                    <ul style="display: flex; list-style: none; gap: var(--spacing-2);">
                        <li><a class="btn btn-outline" href="#" aria-label="Previous"><i class="fas fa-chevron-left"></i></a></li>
                        <li><a class="btn btn-primary" href="#" aria-label="Page 1">1</a></li>
                        <li><a class="btn btn-outline" href="#" aria-label="Page 2">2</a></li>
                        <li><a class="btn btn-outline" href="#" aria-label="Page 3">3</a></li>
                        <li><a class="btn btn-outline" href="#" aria-label="Next"><i class="fas fa-chevron-right"></i></a></li>
                    </ul>
                </nav>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-column">
                    <h3>AtMyWorks</h3>
                    <ul>
                        <li><a href="#">About Us</a></li>
                        <li><a href="#">Careers</a></li>
                        <li><a href="#">Press</a></li>
                        <li><a href="/blog.html">Blog</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>Resources</h3>
                    <ul>
                        <li><a href="#">Help & Support</a></li>
                        <li><a href="#">Trust & Safety</a></li>
                        <li><a href="#">Selling on AtMyWorks</a></li>
                        <li><a href="#">Buying on AtMyWorks</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>Legal</h3>
                    <ul>
                        <li><a href="#">Terms of Service</a></li>
                        <li><a href="#">Privacy Policy</a></li>
                        <li><a href="#">Cookie Policy</a></li>
                        <li><a href="#">Copyright Policy</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2023 AtMyWorks. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- JavaScript Files -->
    <script src="js/main.js"></script>
    <script src="js/auth.js"></script>
    <script>
        // Simple spinner animation
        const style = document.createElement('style');
        style.innerHTML = `
            @keyframes spin {
                to { transform: rotate(360deg); }
            }
            .spinner {
                 animation: spin 1s linear infinite;
            }
        `;
        document.head.appendChild(style);

        document.addEventListener('DOMContentLoaded', function () {
            const jobsContainer = document.getElementById('jobsContainer');
            const jobCountElement = document.getElementById('jobCount');
            const searchForm = document.getElementById('jobSearchForm');
            const searchQueryInput = document.getElementById('jobSearchQuery');
            const categoryFilter = document.getElementById('jobCategoryFilter');
            const typeFilter = document.getElementById('jobTypeFilter');
            const experienceFilter = document.getElementById('jobExperienceFilter');
            const resetFiltersBtn = document.getElementById('resetFiltersBtn');

            // Simulate loading jobs
            function loadJobs(filters = {}) {
                jobsContainer.innerHTML = `
                    <div style="text-align: center; padding: var(--spacing-10);">
                        <div class="spinner" style="width: 3rem; height: 3rem; border: 4px solid rgba(0, 0, 0, 0.1); border-left-color: var(--primary); border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto 1rem;"></div>
                        <p>Loading jobs...</p>
                    </div>
                `;

                // Simulate network delay
                setTimeout(() => {
                    // This is a placeholder. In a real app, you would query Firestore based on filters.
                    const mockJobs = [
                        {
                            id: 'job1',
                            title: 'Senior Web Developer',
                            company: 'Tech Corp',
                            category: 'programming-tech',
                            type: 'Full-Time',
                            experience: 'Expert',
                            salary: '$100k - $150k',
                            description: 'We are looking for a Senior Web Developer to join our team...',
                            postedDate: '2023-10-27'
                        },
                        {
                            id: 'job2',
                            title: 'Graphic Designer',
                            company: 'Creative Agency',
                            category: 'graphics-design',
                            type: 'Contract',
                            experience: 'Intermediate',
                            salary: '$30 - $50 / hr',
                            description: 'Join our creative team to design stunning visuals...',
                            postedDate: '2023-10-26'
                        },
                        {
                            id: 'job3',
                            title: 'Content Writer',
                            company: 'Media Group',
                            category: 'writing-translation',
                            type: 'Freelance',
                            experience: 'Entry',
                            salary: '$25 - $40 / hr',
                            description: 'Create engaging content for our clients...',
                            postedDate: '2023-10-25'
                        }
                    ];

                    let filteredJobs = mockJobs;
                    if (filters.query) {
                        const q = filters.query.toLowerCase();
                        filteredJobs = filteredJobs.filter(job =>
                            job.title.toLowerCase().includes(q) ||
                            job.company.toLowerCase().includes(q) ||
                            job.description.toLowerCase().includes(q)
                        );
                    }
                    if (filters.category) {
                        filteredJobs = filteredJobs.filter(job => job.category === filters.category);
                    }
                    if (filters.type) {
                        filteredJobs = filteredJobs.filter(job => job.type === filters.type);
                    }
                    if (filters.experience) {
                        filteredJobs = filteredJobs.filter(job => job.experience === filters.experience);
                    }

                    jobCountElement.textContent = `Showing ${filteredJobs.length} jobs`;

                    if (filteredJobs.length === 0) {
                        jobsContainer.innerHTML = '<div style="text-align: center; padding: var(--spacing-10);"><p>No jobs found matching your criteria.</p></div>';
                        return;
                    }

                    let jobsHtml = '';
                    filteredJobs.forEach(job => {
                        jobsHtml += `
                            <div class="gig-card" style="margin-bottom: var(--spacing-6);">
                                <div class="gig-content">
                                    <h3 class="gig-title card-title"><a href="/job-detail.html?id=${job.id}" style="text-decoration: none; color: inherit;">${job.title}</a></h3>
                                    <div style="display: flex; flex-wrap: wrap; gap: 1rem; margin-bottom: 1rem; font-size: var(--font-size-sm);">
                                        <div><i class="fas fa-building" style="margin-right: 0.5rem;"></i> ${job.company}</div>
                                        <div><i class="fas fa-briefcase" style="margin-right: 0.5rem;"></i> ${job.type}</div>
                                        <div><i class="fas fa-graduation-cap" style="margin-right: 0.5rem;"></i> ${job.experience}</div>
                                        <div style="color: var(--primary-600); font-weight: var(--font-weight-semibold);"><i class="fas fa-money-bill-wave" style="margin-right: 0.5rem;"></i> ${job.salary}</div>
                                    </div>
                                    <p style="margin-bottom: 1.5rem;">${job.description.substring(0, 150)}...</p>
                                    <div style="display: flex; justify-content: space-between; align-items: center;">
                                        <div style="font-size: var(--font-size-sm); color: var(--gray-500);">
                                            <i class="far fa-calendar" style="margin-right: 0.5rem;"></i> Posted on ${job.postedDate}
                                        </div>
                                        <a href="/job-detail.html?id=${job.id}" class="btn btn-primary">View Details</a>
                                    </div>
                                </div>
                            </div>
                        `;
                    });
                    jobsContainer.innerHTML = jobsHtml;
                }, 1000); // Simulate 1 second delay
            }

            // Initial load
            loadJobs();

            // Handle search and filter form submission
            if (searchForm) {
                searchForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    const filters = {
                        query: searchQueryInput.value.trim(),
                        category: categoryFilter.value,
                        type: typeFilter.value,
                        experience: experienceFilter.value
                    };
                    loadJobs(filters);
                });
            }

            // Handle filter changes
            [categoryFilter, typeFilter, experienceFilter].forEach(filter => {
                filter.addEventListener('change', function() {
                    const filters = {
                        query: searchQueryInput.value.trim(),
                        category: categoryFilter.value,
                        type: typeFilter.value,
                        experience: experienceFilter.value
                    };
                    loadJobs(filters);
                });
            });

            // Handle reset filters
            if (resetFiltersBtn) {
                resetFiltersBtn.addEventListener('click', function() {
                    searchQueryInput.value = '';
                    categoryFilter.value = '';
                    typeFilter.value = '';
                    experienceFilter.value = '';
                    loadJobs(); // Reload with no filters
                });
            }
        });
    </script>
</body>
</html>